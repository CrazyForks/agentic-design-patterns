# 附录 G \- 编码 Agent

# Vibe 编码：一个起点

"Vibe 编码"已成为快速创新和创意探索的强大技术。这种实践涉及使用 LLM 生成初始草稿、概述复杂逻辑或构建快速原型，显著减少初始摩擦。它对于克服"空白页"问题非常宝贵，使开发者能够快速从模糊的概念过渡到具体的、可运行的代码。Vibe 编码在探索不熟悉的 API 或测试新颖的架构模式时特别有效，因为它绕过了对完美实现的即时需求。生成的代码通常充当创意催化剂，为开发者提供批判、重构和扩展的基础。其主要优势在于能够加速软件生命周期的初始发现和构思阶段。然而，虽然 vibe 编码擅长头脑风暴，但开发稳健、可扩展和可维护的软件需要更结构化的方法，从纯粹的生成转向与专门的编码 Agent 的协作伙伴关系。

# Agent 作为团队成员

虽然最初的浪潮专注于原始代码生成——完美适合构思的"vibe 代码"——但行业现在正在转向一种更集成和强大的生产工作范式。最有效的开发团队不仅仅是将任务委托给 Agent；他们正在用一套复杂的编码 Agent 来增强自己。这些 Agent 作为不知疲倦的专业团队成员，放大人类创造力并显著提高团队的可扩展性和速度。

这种演变反映在行业领导者的声明中。2025 年初，Alphabet 首席执行官 Sundar Pichai 指出，在 Google，**"超过 30% 的新代码现在由我们的 Gemini 模型辅助或生成，从根本上改变了我们的开发速度。"** Microsoft 也提出了类似的声明。这种全行业的转变表明，真正的前沿不是替代开发者，而是赋能他们。目标是一种增强关系，人类指导架构愿景和创造性问题解决，而 Agent 处理专门的、可扩展的任务，如测试、文档编写和审查。

本章提出了一个基于核心理念组织人机协作团队的框架，即人类开发者充当创意领导和架构师，而 AI Agent 充当力量倍增器。该框架基于三个基本原则：

1. **人类主导的编排：** 开发者是团队负责人和项目架构师。他们始终在循环中，编排工作流程，设定高级目标，并做出最终决策。Agent 很强大，但它们是支持性的协作者。开发者指导要使用哪个 Agent，提供必要的上下文，最重要的是，对任何 Agent 生成的输出行使最终判断，确保它符合项目的质量标准和长期愿景。  
2. **上下文的首要性：** Agent 的性能完全取决于其上下文的质量和完整性。具有糟糕上下文的强大 LLM 是无用的。因此，我们的框架优先考虑由人类主导的精心策划上下文的方法。避免自动化的黑盒上下文检索。开发者负责为其 Agent 团队成员组装完美的"简报"。这包括：  
   * **完整的代码库：** 提供所有相关源代码，以便 Agent 理解现有模式和逻辑。  
   * **外部知识：** 提供特定文档、API 定义或设计文档。  
   * **人类简报：** 阐明清晰的目标、需求、拉取请求描述和风格指南。  
3. **直接模型访问：** 为了获得最先进的结果，Agent 必须由直接访问前沿模型（例如，Gemini 2.5 PRO、Claude Opus 4、OpenAI、DeepSeek 等）驱动。使用较弱的模型或通过模糊或截断上下文的中介平台路由请求将降低性能。该框架建立在创建人类领导和底层模型原始能力之间最纯粹的对话基础上，确保每个 Agent 以其峰值潜力运行。

该框架被构造为一个专业 Agent 团队，每个 Agent 都为开发生命周期中的核心功能而设计。人类开发者充当中央编排者，委派任务并整合结果。

## 核心组件

为了有效利用前沿大语言模型，该框架将不同的开发角色分配给一个专业 Agent 团队。这些 Agent 不是独立的应用程序，而是通过精心制作的、特定角色的提示词和上下文在 LLM 中调用的概念性人格。这种方法确保模型的巨大能力精确地集中在手头的任务上，从编写初始代码到执行细致的、关键性的审查。

**编排者：人类开发者：** 在这个协作框架中，人类开发者充当编排者，作为 AI Agent 的中央智能和最终权威。

* **角色：** 团队负责人、架构师和最终决策者。编排者定义任务，准备上下文，并验证 Agent 完成的所有工作。  
  * **界面：** 开发者自己的终端、编辑器以及所选 Agent 的原生 Web UI。

**上下文准备区：** 作为任何成功 Agent 交互的基础，上下文准备区是人类开发者精心准备完整且特定于任务的简报的地方。

* **角色：** 每个任务的专用工作空间，确保 Agent 收到完整准确的简报。  
  * **实现：** 一个临时目录（task-context/），包含目标的 markdown 文件、代码文件和相关文档。

**专业 Agent：** 通过使用有针对性的提示词，我们可以构建一个专业 Agent 团队，每个都针对特定的开发任务量身定制。

* **脚手架 Agent：实施者**  
  * **目的：** 根据详细规范编写新代码、实施功能或创建样板。  
    * **调用提示词：** "你是一名高级软件工程师。根据 01\_BRIEF.md 中的需求和 02\_CODE/ 中的现有模式，实现该功能..."  
  * **测试工程师 Agent：质量守卫**  
    * **目的：** 为新代码或现有代码编写全面的单元测试、集成测试和端到端测试。  
    * **调用提示词：** "你是一名质量保证工程师。对于 02\_CODE/ 中提供的代码，使用 \[测试框架，例如 pytest\] 编写完整的单元测试套件。覆盖所有边缘情况并遵守项目的测试理念。"  
  * **文档编写 Agent：书记员**  
    * **目的：** 为函数、类、API 或整个代码库生成清晰、简洁的文档。  
    * **调用提示词：** "你是一名技术作家。为提供的代码中定义的 API 端点生成 markdown 文档。包括请求/响应示例并解释每个参数。"  
  * **优化 Agent：重构伙伴**  
    * **目的：** 提出性能优化和代码重构建议，以提高可读性、可维护性和效率。  
    * **调用提示词：** "分析提供的代码以查找性能瓶颈或可以重构以提高清晰度的区域。提出具体更改及其改进原因的解释。"  
  * **流程 Agent：代码监督员**  
    * **批判：** Agent 执行初步检查，识别潜在的 bug、风格违规和逻辑缺陷，就像静态分析工具一样。  
    * **反思：** 然后 Agent 分析自己的批判。它综合发现，优先处理最关键的问题，驳回迂腐或低影响的建议，并为人类开发者提供高级的、可操作的摘要。  
    * **调用提示词：** "你是一名首席工程师进行代码审查。首先，对更改进行详细批判。其次，反思你的批判，提供关于最重要反馈的简洁、优先级摘要。"

最终，这种人类主导的模型在开发者的战略方向和 Agent 的战术执行之间创造了强大的协同作用。因此，开发者可以超越日常任务，将他们的专业知识集中在提供最大价值的创意和架构挑战上。

# 实践实施

## 设置清单

为了有效实施人机协作团队框架，建议进行以下设置，重点是在提高效率的同时保持控制。

1. **配置前沿模型访问权限** 为至少两个领先的大语言模型（如 Gemini 2.5 Pro 和 Claude 4 Opus）获取 API 密钥。这种双提供商方法允许进行比较分析，并对冲单一平台限制或停机时间。这些凭据应像管理任何其他生产秘密一样安全管理。  
2. **实施本地上下文编排器** 使用轻量级 CLI 工具或本地 Agent 运行器来管理上下文，而不是临时脚本。这些工具应允许你在项目根目录中定义一个简单的配置文件（例如，context.toml），指定要编译到 LLM 提示词的单个有效载荷中的文件、目录甚至 URL。这确保你对模型在每个请求中看到的内容保持完全、透明的控制。  
3. **建立版本控制的提示词库** 在项目的 Git 仓库中创建一个专用的 /prompts 目录。在其中，将每个专业 Agent 的调用提示词（例如，reviewer.md、documenter.md、tester.md）存储为 markdown 文件。将提示词视为代码允许整个团队随着时间的推移协作、完善和版本化给 AI Agent 的指令。  
4. **将 Agent 工作流与 Git 钩子集成** 通过使用本地 Git 钩子自动化你的审查节奏。例如，pre-commit 钩子可以配置为自动在你的暂存更改上触发审查者 Agent。Agent 的批判和反思摘要可以直接在你的终端中呈现，在你完成提交之前提供即时反馈，并将质量保证步骤直接嵌入到你的开发过程中。

**![][image1]**

图 1：编码专家示例

## 领导增强团队的原则

成功领导这个框架需要从单独贡献者演变为人机协作团队的领导者，遵循以下原则：

* **保持架构所有权** 你的角色是设定战略方向并拥有高级架构。你定义"是什么"和"为什么"，使用 Agent 团队加速"如何"。你是设计的最终**仲裁者**，确保每个组件与项目的长期愿景和质量标准保持一致。  
* **掌握简报的艺术** Agent 输出的质量是其输入质量的直接反映。通过为每个任务提供清晰、明确和全面的上下文来掌握简报的艺术。将你的提示词视为不是简单的命令，而是为新的、高度有能力的团队成员提供的完整简报包。  
* **充当最终质量关卡** Agent 的输出始终是一个提案，永远不是命令。将审查者 Agent 的反馈视为强大的信号，但你是最终的质量关卡。应用你的领域专业知识和项目特定知识来验证、挑战和批准所有更改，充当代码库完整性的最终守护者。  
* **参与迭代对话** 最佳结果来自对话，而不是独白。如果 Agent 的初始输出不完美，不要丢弃它——完善它。提供纠正性反馈，添加澄清上下文，并提示再次尝试。这种迭代对话至关重要，特别是与审查者 Agent，其"反思"输出旨在成为协作讨论的开始，而不仅仅是最终报告。

# 结论

代码开发的未来已经到来，它是增强的。孤独编码者的时代已经让位于一个新范式，开发者领导专业 AI Agent 团队。这个模型不会削弱人类角色；它通过自动化日常任务、扩大个人影响力并实现以前无法想象的开发速度来提升它。

通过将战术执行卸载给 Agent，开发者现在可以将他们的认知能量专注于真正重要的事情：战略创新、弹性架构设计，以及构建令用户满意的产品所需的创造性问题解决。基本关系已经重新定义；这不再是人类与机器的竞赛，而是人类独创性与 AI 之间的伙伴关系，作为一个无缝集成的团队工作。

# 参考文献

1. AI is responsible for generating more than 30% of the code at Google [https://www.reddit.com/r/singularity/comments/1k7rxo0/ai\_is\_now\_writing\_well\_over\_30\_of\_the\_code\_at/](https://www.reddit.com/r/singularity/comments/1k7rxo0/ai_is_now_writing_well_over_30_of_the_code_at/)   
2. AI is responsible for generating more than 30% of the code at Microsoft [https://www.businesstoday.in/tech-today/news/story/30-of-microsofts-code-is-now-ai-generated-says-ceo-satya-nadella-474167-2025-04-30](https://www.businesstoday.in/tech-today/news/story/30-of-microsofts-code-is-now-ai-generated-says-ceo-satya-nadella-474167-2025-04-30) 

[image1]: ../images/appendix-g/image1.png